Задачи

Получение, отслеживание состояния и хранение заказа. 
- получить заказ
- внести изменение в состояние
- вернуть текущее состояние
- вернутрь список заказов за период (отчет)



Порядок работы
1) админ  добавляет разрешенные api_key, команда 'new_api_key'
2) используя api_key заказчик создает заказ, команда 'new_order'
3) по запросу отдаем информацию о заказе, команда 'order_info'
4) по запросу меняем информацию о заказе, команда 'order_status_edit'
5) по запросу отдаем массив заказов за период, команда 'order_list'


Таблицы 

api_keys - список разрешенных ключей
	name - первычный ключ (название магазина)
	api_key

orders  - список заказов
	id - номер заказа в этой таблице, первычный ключ
	name  -  заказчик, из таблицы api_keys
	order_number - номер заказа в системе заказчика
	inn - ИНН компании (клиент)
	address - текст
	email - текст
	phone - текст
	device - устройство (номер изделия, номер программы, аккаунт облака) - текст
	order - JSON строка массива позиций заказа
		order:[{code:'', piece:'', price:''},{},{}]
	sum - общая сумма заказа - вычисляется при создании записи
	date_order - дата создания заказа
	date_complete - дата завершения заказа
	proforma - номер документа - текст
	invoice - номер документа  - текст
	license - номер документа  - текст

ПРОТОКОЛ

добавить(изменить) разрешенный api_key 
объект запроса
{
	admin_key:'74965',
	command:'new_api_key',
	data: {
		name: 'vasa',
		api_key: '5286'
	}
}
объект ответа
{
	command:'new_api_key',	
	data: {
		name: 'vasa',
		result: 'edit', ('new')
	}
}

удалить name 
объект запроса
{
	admin_key:'74965',
	command:'dell_name',
	data: {
		name: 'vasa',
	}
}
объект ответа
{
	command:'dell_name',	
	data: {
		name: 'vasa',
		result: 'dell'
	}
}

Создать заказ
объект запроса
{
	api_key:'2345678',
	command:'new_order',
	data: {
		inn: '',
		order_number:'',
		order:[{code:'',piece:'',price:''},{code:'',piece:'',price:''},{code:'',piece:'',price:''},],
		email:'',
		phone:'',
		address:'',
		device:''	
	}
}
объект ответа
{
	command:'new_order',	
	data: {
		order_number:'',
		result: 'new',
		id:'38'
	}
}

получить информацию о заказе
объект запроса
{
	api_key:'2345678',
	command:'order_info',
	data: {
		id: '',   // смотри *
		order_number:''	 // смотри *
	}
} 
	//*  используем одно из полей, если заполнены оба, то ищем по id, если такого заказа нет, то ищем по order_number 
объект ответа
{
	command:'order_info',	
	data: {
		id: '',
		order_number:'',
		inn: '',
		order_number:'',
		order:[{code:'',piece:'',price:''},{code:'',piece:'',price:''},{code:'',piece:'',price:''},],
		email:'',
		phone:'',
		address:'',
		device:'',
		sum:'',
		date_order:'',
		date_complete:'',
		proforma:'',
		invoice:'', 
		license:'' 
	}
}

Изменить статус заказа
объект запроса
{
	api_key:'2345678',
	command:'order_status_edit',
	data: {
		id: '',  // смотри *  
		order_number:''	 // смотри *  
		date_complete:'',
		proforma:'',
		invoice:'', 
		license:'' 
	}
}
объект ответа
{
	command:'order_status_edit',	
	data: {
		order_number:'',
		id:'',
		result: 'edit'
	}
}

Получить список своих заказов за период (проверяем дату создания заказа)
объект запроса
{
	api_key:'2345678',
	command:'order_list',
	data: {
		from: '', 
		to:''	
	}
}
объект ответа
{
	command:'order_list',	
	data: {
		order_list:[] // массив объектов заказов
	} 
}

Получить список всех заказов за период  (проверяем дату создания заказа)
объект запроса
{
	admin_key:'74965',
	command:'order_list_all',
	data: {
		from: '',
		to:''	
	}
}
объект ответа
{
	command:'order_list_all',	
	data: {
		order_list:[]
	} 
}

объект заказа для order_list
	{
		id: '',
		order_number:'',
		inn: '',
		order_number:'',
		order:[{code:'',piece:'',price:''},{code:'',piece:'',price:''},{code:'',piece:'',price:''},],
		email:'',
		phone:'',
		address:'',
		device:'',
		sum:'',
		date_order:'',
		date_complete:'',
		proforma:'',
		invoice:'', 
		license:'' 
	}

admin_key - хранится прямо в коде сервера в виде объявления переменной
